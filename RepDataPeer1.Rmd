---
title: "RepData_PeerAssessment1"
author: "Amanda Molling"
date: "Saturday, March 14, 2015"
output: html_document
---
This is the summary of the data that was read in:   

```{r}
unzip("activity.zip")
 activityData <- read.csv("activity.csv")
summary(activityData)
head(activityData)
```
If I wanted to convert my dates to type date, I could use. 

```{r, echo=TRUE}
activityData$date <- as.Date(activityData$date)


```
I computed the mean, median, and sum data as follows:

```{r}
totalDailySteps <- aggregate(steps ~ date, activityData, sum)
meanDailySteps <- aggregate(steps ~ date, activityData, mean)
medDailySteps <- aggregate(steps ~ date, activityData, mean)
```
Then my histogram:

```{r}
hist(totalDailySteps[, 2], breaks = 20, xlab = "Total Steps Each Day", main = "Histogram of Total Daily Steps Taken")
```
Followed by analysis on that data:
```{r}
mean(totalDailySteps[, 2])
median(totalDailySteps[,2])
```
Further analysis comparing the average number of steps at each time interval across the days yields:
```{r}
meanDailyStepsByInterval <- aggregate(steps ~ interval, activityData, mean)
library('lattice')
xyplot(steps ~ interval, meanDailyStepsByInterval, xlab = "
       ")
```
The time interval with the most steps is found to be 835.
```{r}

which(meanDailyStepsByInterval == max(meanDailyStepsByInterval[2]), arr.ind = TRUE)
```
where the value is:

```{r}

max(meanDailyStepsByInterval[,2])

## And the specific interval is :

meanDailyStepsByInterval[104, 1]
```

For the second part, I find the number of complete cases and build a table. Then, I can subtract the good cases from the total number of obs. Another way to do this is by simply calculating the number of bad cases as shown.

```{r}
##I make the good data first
good <-complete.cases(activityData)

goodData<-activityData[good,][,]
nrow(goodData)
nrow(activityData) - nrow(goodData)

##That is the number of bad rows
## The second method:
badData <- activityData[!good,][,]
nrow(badData)
```

Now to fill in the data, I use my mean data from before:
```{r}
newActivityData <- activityData
for (i in 1 : (nrow(activityData) )){
  if ( ( is.na( activityData[ i , 1] ) ) & ( i < nrow(meanDailyStepsByInterval) ) ) {
    newActivityData[ i , 1] <- meanDailyStepsByInterval[ ( i %% ( nrow(meanDailyStepsByInterval) ) ), 2]
  }
  else if ( (is.na(activityData[ i, 1]) ) & ( i >= nrow(meanDailyStepsByInterval) ) ) {
    newActivityData[ i , 1] <- meanDailyStepsByInterval[ ( (i %% nrow(meanDailyStepsByInterval) ) + 1 ), 2]
  }
}
head(newActivityData)
tail(newActivityData)
head(meanDailyStepsByInterval)
tail(meanDailyStepsByInterval)

